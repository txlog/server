<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>{{ .title }}</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
	<style>
		.login-container {
			min-height: 100vh;
			display: flex;
			align-items: center;
			justify-content: center;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		}
		
		.login-card {
			background: white;
			border-radius: 15px;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
			overflow: hidden;
			max-width: 400px;
			width: 100%;
		}
		
		.login-header {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			padding: 2rem;
			text-align: center;
		}
		
		.login-body {
			padding: 2rem;
		}
		
		.btn-oidc {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			border: none;
			color: white;
			padding: 12px 20px;
			font-weight: 500;
			border-radius: 8px;
			transition: transform 0.2s, box-shadow 0.2s;
		}
		
		.btn-oidc:hover {
			transform: translateY(-2px);
			box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
			color: white;
		}
		
		.alert {
			border-radius: 8px;
			border: none;
		}
		
		.brand-logo {
			width: 60px;
			height: 60px;
			background: white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 auto 1rem;
			font-size: 1.5rem;
			color: #667eea;
		}
	</style>
</head>

<body>
	<div class="login-container">
		<div class="login-card">
			<div class="login-header">
				<div class="brand-logo">
					<i class="bi bi-database"></i>
				</div>
				<h3 class="mb-0">Txlog Server</h3>
				<p class="mb-0 opacity-75">Transaction Logging System</p>
			</div>
			
			<div class="login-body">
				<h4 class="text-center mb-4">Welcome Back</h4>
				
				<!-- Error Messages -->
				<div id="error-container">
					<script>
						const urlParams = new URLSearchParams(window.location.search);
						const error = urlParams.get('error');
						
						if (error) {
							let errorMessage = 'An error occurred during authentication.';
							
							switch (error) {
								case 'auth_failed':
									errorMessage = 'Authentication failed. Please try again.';
									break;
								case 'invalid_state':
									errorMessage = 'Invalid request state. Please try again.';
									break;
								case 'token_exchange_failed':
									errorMessage = 'Failed to exchange authorization code.';
									break;
								case 'id_token_missing':
									errorMessage = 'ID token is missing from the response.';
									break;
								case 'id_token_invalid':
									errorMessage = 'ID token verification failed.';
									break;
								case 'user_creation_failed':
									errorMessage = 'Failed to create or update user account.';
									break;
								case 'account_disabled':
									errorMessage = 'Your account has been disabled. Please contact an administrator.';
									break;
								case 'session_creation_failed':
									errorMessage = 'Failed to create user session.';
									break;
							}
							
							document.getElementById('error-container').innerHTML = 
								'<div class="alert alert-danger" role="alert">' +
								'<i class="bi bi-exclamation-triangle me-2"></i>' + errorMessage +
								'</div>';
						}
					</script>
				</div>
				
				<p class="text-muted text-center mb-4">
					Sign in with your OIDC provider to access the Txlog dashboard
				</p>
				
				<div class="d-grid">
					<form action="/auth/login" method="post">
						<button type="submit" class="btn btn-oidc w-100">
							<i class="bi bi-shield-check me-2"></i>
							Sign in with OIDC
						</button>
					</form>
				</div>
				
				<div class="text-center mt-4">
					<small class="text-muted">
						<i class="bi bi-info-circle me-1"></i>
						Secure authentication powered by OpenID Connect
					</small>
				</div>
			</div>
		</div>
	</div>
	
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>